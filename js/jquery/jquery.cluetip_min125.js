/*!
 * jQuery clueTip plugin v1.2.5
 *
 * Date: Mon Jan 16 23:33:54 2012 EST
 * Requires: jQuery v1.3+
 *
 * Copyright 2011, Karl Swedberg
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 *
 *
 * Examples can be found at http://plugins.learningjquery.com/cluetip/demo/
 *
*/
(function(a){a.cluetip={version:"1.2.5",template:["<div>",'<div class="cluetip-outer">','<h3 class="cluetip-title ui-widget-header ui-cluetip-header"></h3>','<div class="cluetip-inner ui-widget-content ui-cluetip-content"></div>',"</div>",'<div class="cluetip-extra"></div>','<div class="cluetip-arrows ui-state-default"></div>',"</div>"].join(""),setup:{insertionType:"appendTo",insertionElement:"body"},defaults:{multiple:false,width:275,height:"auto",cluezIndex:97,positionBy:"auto",topOffset:15,leftOffset:15,local:false,localPrefix:null,localIdSuffix:null,hideLocal:true,attribute:"rel",titleAttribute:"title",splitTitle:"",escapeTitle:false,showTitle:true,cluetipClass:"default",hoverClass:"",waitImage:true,cursor:"help",arrows:false,dropShadow:true,dropShadowSteps:6,sticky:false,mouseOutClose:false,activation:"hover",clickThrough:true,tracking:false,delayedClose:0,closePosition:"top",closeText:"Close",truncate:0,fx:{open:"show",openSpeed:""},hoverIntent:{sensitivity:3,interval:50,timeout:0},onActivate:function(a){return true},onShow:function(a,b){},onHide:function(a,b){},ajaxCache:true,ajaxProcess:function(a){a=a.replace(/<(script|style|title)[^<]+<\/(script|style|title)>/gm,"").replace(/<(link|meta)[^>]+>/g,"");return a},ajaxSettings:{dataType:"html"},debug:false}};var b,c="cluetip ui-widget ui-widget-content ui-cluetip",d={},e=0,f=0;a.fn.attrProp=a.fn.prop||a.fn.attr;a.fn.cluetip=function(g,h){function x(b,c,d){var e="",f=c.dropShadow&&c.dropShadowSteps?+c.dropShadowSteps:0;if(a.support.boxShadow){if(f){e="1px 1px "+f+"px rgba(0,0,0,0.5)"}var g=f===0?"0 0 ":"1px 1px ";b.css(a.support.boxShadow,e);return false}var h=b.find(".cluetip-drop-shadow");if(f==h.length){return h}h.remove();var i=[];for(var j=0;j<f;){i[j++]='<div style="top:'+j+"px;left:"+j+'px;"></div>'}d=a(i.join("")).css({position:"absolute",backgroundColor:"#000",zIndex:p-1,opacity:.1}).addClass("cluetip-drop-shadow").prependTo(b);return d}function w(){}var i,j,k,l,m,n;if(typeof g=="object"){h=g;g=null}if(g=="destroy"){var o=this.data("cluetip");if(o){a(o.selector).remove();a.removeData(this,"title");a.removeData(this,"cluetip");a(document).unbind(".cluetip");return this.unbind(".cluetip")}}h=a.extend(true,{},a.cluetip.defaults,h||{});e++;var p,q=a.cluetip.backCompat||!h.multiple?"cluetip":"cluetip-"+e,r="#"+q,s=a.cluetip.backCompat?"#":".",t=a.cluetip.setup.insertionType,u=a.cluetip.setup.insertionElement||"body";t=/appendTo|prependTo|insertBefore|insertAfter/.test(t)?t:"appendTo";i=a(r);if(!i.length){i=a(a.cluetip.template)[t](u).attr("id",q).css({position:"absolute",display:"none"});p=+h.cluezIndex;k=i.find(s+"cluetip-outer").css({position:"relative",zIndex:p});j=i.find(s+"cluetip-inner");l=i.find(s+"cluetip-title")}b=a("#cluetip-waitimage");if(!b.length){b=a("<div></div>").attr("id","cluetip-waitimage").css({position:"absolute"})}b.insertBefore(i).hide();var v=(parseInt(i.css("paddingLeft"),10)||0)+(parseInt(i.css("paddingRight"),10)||0);this.each(function(e){function bc(a,b){var c=a.status;b.beforeSend(a.xhr,b);if(c=="error"){b[c](a.xhr,a.textStatus)}else if(c=="success"){b[c](a.data,a.textStatus,a.xhr)}b.complete(a.xhr,b.textStatus)}function X(){return false}var o=this,q=a(this),t=a.extend(true,{},h,a.metadata?q.metadata():a.meta?q.data():q.data("cluetip")||{}),u=false,w=false,y=0,z=t[t.attribute]||(t.attribute=="href"?q.attr(t.attribute):q.attrProp(t.attribute)||q.attr(t.attribute)),A=t.cluetipClass;p=+t.cluezIndex;q.data("cluetip",{title:o.title,zIndex:p,selector:r});if(!z&&!t.splitTitle&&!g){return true}if(t.local&&t.localPrefix){z=t.localPrefix+z}if(t.local&&t.hideLocal&&z){a(z+":first").hide()}var B=parseInt(t.topOffset,10),C=parseInt(t.leftOffset,10);var D,E,F=isNaN(parseInt(t.height,10))?"auto":/\D/g.test(t.height)?t.height:t.height+"px";var G,H,I,J,K,L;var M=parseInt(t.width,10)||275,N=M+v+t.dropShadowSteps,O=this.offsetWidth,P,Q,R,S,T;var U;var V=t.attribute!="title"?q.attrProp(t.titleAttribute)||"":"";if(t.splitTitle){U=V.split(t.splitTitle);V=t.showTitle||U[0]===""?U.shift():""}if(t.escapeTitle){V=V.replace(/&/g,"&").replace(/>/g,">").replace(/</g,"<")}var W;var Y=function(c){var n,p=t.onActivate(q),v;if(p===false){return false}w=true;i=a(r).css({position:"absolute"});k=i.find(s+"cluetip-outer");j=i.find(s+"cluetip-inner");l=i.find(s+"cluetip-title");m=i.find(s+"cluetip-arrows");i.removeClass().css({width:M});if(z==q.attr("href")){q.css("cursor",t.cursor)}if(t.hoverClass){q.addClass(t.hoverClass)}H=I=q.offset().top;P=q.offset().left;O=q.innerWidth();if(c.type==focus){S=P+O/2+C;i.css({left:Q});K=I+B}else{S=c.pageX;K=c.pageY}if(o.tagName.toLowerCase()!="area"){G=a(document).scrollTop();T=a(window).width()}if(t.positionBy=="fixed"){Q=O+P+C;i.css({left:Q})}else{Q=O>P&&P>N||P+O+N+C>T?P-N-C:O+P+C;if(o.tagName.toLowerCase()=="area"||t.positionBy=="mouse"||O+N>T){if(S+20+N>T){i.addClass("cluetip-"+A);Q=S-N-C>=0?S-N-C-parseInt(i.css("marginLeft"),10)+parseInt(j.css("marginRight"),10):S-N/2}else{Q=S+C}}n=Q<0?c.pageY+B:c.pageY;if(Q<0||t.positionBy=="bottomTop"){Q=S+N/2>T?T/2-N/2:Math.max(S-N/2,0)}}m.css({zIndex:q.data("cluetip").zIndex+1});i.css({left:Q,zIndex:q.data("cluetip").zIndex});E=a(window).height();if(g){if(typeof g=="function"){g=g.call(o)}j.html(g);Z(n)}else if(U){var x=U.length;j.html(x?U[0]:"");if(x>1){for(var y=1;y<x;y++){j.append('<div class="split-body">'+U[y]+"</div>")}}Z(n)}else if(!t.local&&z.indexOf("#")!==0){if(/\.(jpe?g|tiff?|gif|png)(?:\?.*)?$/i.test(z)){j.html('<img src="'+z+'" alt="'+V+'" />');Z(n)}else{var D=t.ajaxSettings.beforeSend,F=t.ajaxSettings.error,J=t.ajaxSettings.success,L=t.ajaxSettings.complete;var R={cache:t.ajaxCache,url:z,beforeSend:function(a,c){if(D){D.call(o,a,i,j,c)}k.children().empty();if(t.waitImage){b.css({top:K+20,left:S+20,zIndex:q.data("cluetip").zIndex-1}).show()}},error:function(a,b){if(h.ajaxCache&&!d[z]){d[z]={status:"error",textStatus:b,xhr:a}}if(w){if(F){F.call(o,a,b,i,j)}else{j.html("<i>sorry, the contents could not be loaded</i>")}}},success:function(a,b,c){if(h.ajaxCache&&!d[z]){d[z]={status:"success",data:a,textStatus:b,xhr:c}}u=t.ajaxProcess.call(o,a);if(typeof u=="object"&&u!==null){V=u.title;u=u.content}if(w){if(J){J.call(o,a,b,i,j)}j.html(u)}},complete:function(c,d){if(L){L.call(o,c,d,i,j)}var e=j[0].getElementsByTagName("img");f=e.length;for(var g=0,h=e.length;g<h;g++){if(e[g].complete){f--}}if(f&&!a.browser.opera){a(e).bind("load.ct error.ct",function(){f--;if(f===0){b.hide();a(e).unbind(".ct");if(w){Z(n)}}})}else{b.hide();if(w){Z(n)}}}};v=a.extend(true,{},t.ajaxSettings,R);if(d[z]){bc(d[z],v)}else{a.ajax(v)}}}else if(t.local){var W=a(z+(/^#\S+$/.test(z)?"":":eq("+e+")")).clone(true).show();if(t.localIdSuffix){W.attr("id",W[0].id+t.localIdSuffix)}j.html(W);Z(n)}};var Z=function(b){var d,e,f,g=V||t.showTitle&&" ",h="",p="";i.addClass("cluetip-"+A);if(t.truncate){var r=j.text().slice(0,t.truncate)+"...";j.html(r)}if(g){l.show().html(g)}else{l.hide()}if(t.sticky){d=a('<div class="cluetip-close"><a href="#">'+t.closeText+"</a></div>");t.closePosition=="bottom"?d.appendTo(j):t.closePosition=="title"?d.prependTo(l):d.prependTo(j);d.bind("click.cluetip",function(){ba();return false});if(t.mouseOutClose){i.bind("mouseleave.cluetip",function(){ba()})}else{i.unbind("mouseleave.cluetip")}}k.css({zIndex:q.data("cluetip").zIndex,overflow:F=="auto"?"visible":"auto",height:F});D=F=="auto"?Math.max(i.outerHeight(),i.height()):parseInt(F,10);J=I;L=G+E;if(t.positionBy=="fixed"){J=I-t.dropShadowSteps+B}else if(Q<S&&Math.max(Q,0)+N>S||t.positionBy=="bottomTop"){if(I+D+B>L&&K-G>D+B){J=K-D-B;p="top"}else{J=K+B;p="bottom"}}else if(I+D+B>L){J=D>=E?G:L-D-B}else if(q.css("display")=="block"||o.tagName.toLowerCase()=="area"||t.positionBy=="mouse"){J=b-B}else{J=I-t.dropShadowSteps}if(p===""){p=Q<P?"left":"right"}e=" clue-"+p+"-"+A+" cluetip-"+A;if(A=="rounded"){e+=" ui-corner-all"}i.css({top:J+"px"}).attrProp({className:c+e});if(t.arrows){if(/(left|right)/.test(p)){f=i.height()-m.height();h=Q>=0&&b>0?I-J-t.dropShadowSteps:0;h=f>h?h:f;h+="px"}m.css({top:h}).show()}else{m.hide()}n=x(i,t);if(n&&n.length){n.hide().css({height:D,width:M,zIndex:q.data("cluetip").zIndex-1}).show()}i.hide()[t.fx.open](t.fx.openSpeed||0);if(a.fn.bgiframe){i.bgiframe()}if(t.delayedClose>0){y=setTimeout(ba,t.delayedClose)}t.onShow.call(o,i,j)};var _=function(a){w=false;b.hide();if(!t.sticky||/click|toggle/.test(t.activation)){ba();clearTimeout(y)}if(t.hoverClass){q.removeClass(t.hoverClass)}};var ba=function(b){var c=b&&b.data("cluetip")?b:q,d=c.data("cluetip")&&c.data("cluetip").selector,e=d||"div.cluetip",f=a(e),g=f.find(s+"cluetip-inner"),h=f.find(s+"cluetip-arrows");f.hide().removeClass();t.onHide.call(c[0],f,g);if(d){c.removeClass("cluetip-clicked");c.css("cursor","")}if(d&&V){c.attrProp(t.titleAttribute,V)}if(t.arrows){h.css({top:""})}};a(document).unbind("hideCluetip.cluetip").bind("hideCluetip.cluetip",function(b){ba(a(b.target))});if(/click|toggle/.test(t.activation)){q.bind("click.cluetip",function(b){if(i.is(":hidden")||!q.is(".cluetip-clicked")){Y(b);a(".cluetip-clicked").removeClass("cluetip-clicked");q.addClass("cluetip-clicked")}else{_(b)}return false})}else if(t.activation=="focus"){q.bind("focus.cluetip",function(a){q.attrProp("title","");Y(a)});q.bind("blur.cluetip",function(a){q.attrProp("title",q.data("cluetip").title);_(a)})}else{q[t.clickThrough?"unbind":"bind"]("click.cluetip",X);var bb=function(a){if(t.tracking){var b=Q-a.pageX;var c=J?J-a.pageY:I-a.pageY;q.bind("mousemove.cluetip",function(a){i.css({left:a.pageX+b,top:a.pageY+c})})}};if(a.fn.hoverIntent&&t.hoverIntent){q.hoverIntent({sensitivity:t.hoverIntent.sensitivity,interval:t.hoverIntent.interval,over:function(a){Y(a);bb(a)},timeout:t.hoverIntent.timeout,out:function(a){_(a);q.unbind("mousemove.cluetip")}})}else{q.bind("mouseenter.cluetip",function(a){Y(a);bb(a)}).bind("mouseleave.cluetip",function(a){_(a);q.unbind("mousemove.cluetip")})}q.bind("mouseover.cluetip",function(a){q.attrProp("title","")}).bind("mouseleave.cluetip",function(a){q.attrProp("title",q.data("cluetip").title)})}});return this};(function(){a.support=a.support||{};var b=document.createElement("div"),c=b.style,d=["boxShadow"],e=["moz","Moz","webkit","o"];for(var f=0,g=d.length;f<g;f++){var h=d[f],i=h.charAt(0).toUpperCase()+h.slice(1);if(typeof c[h]!=="undefined"){a.support[h]=h}else{for(var j=0,k=e.length;j<k;j++){if(typeof c[e[j]+i]!=="undefined"){a.support[h]=e[j]+i;break}}}}b=null})();a.fn.cluetip.defaults=a.cluetip.defaults})(jQuery)